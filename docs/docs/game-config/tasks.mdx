---
sidebar_position: 4
---

import CodeBlock from '@theme/CodeBlock';
import generateResolverOptions from "@site/src/components/shared-lib/generateResolverOptions.tsx";
import JSONSchemaViewer from "@theme/JSONSchemaViewer";
import TaskSchema from "@site/static/schemas/taskSchema.json";

# Tasks

During the game-based study, participants complete various tasks related to smart home devices. These tasks range from simple actions like turning on devices to complex scenarios where smart home rules intentionally create impossible situations. For example, a task might require making coffee while rules automatically power off the coffee machine, creating an intentionally impossible scenario to study participant behavior.

## JSON Schema

<JSONSchemaViewer schema={ TaskSchema } resolverOptions={generateResolverOptions({"basePath": "/schemas"})} />

## Global Task Configuration

Tasks have four primary global properties that control their presentation, timing, and the optional ability to abort the task: `ordered`, `timer`, `abortable`, and `abortionOptions`.

### Tasks Property: Order

The `ordered` property determines whether tasks appear in a fixed sequence or random order.

```json
{
    "ordered": true,
    "tasks": [
        { "id": "task_a", "description": "First task" },
        { "id": "task_b", "description": "Second task" },
        { "id": "task_c", "description": "Third task" }
    ]
}
```

#### Order Behavior

- When `ordered: true`: Tasks appear in array order (i.e.,., Task A → Task B → Task C)
- When `ordered: false`: Tasks are shuffled (e.g., Task C → Task A → Task B)

:::tip Choosing Task Order
Use ordered tasks when:
- Tasks follow a logical progression
- Later tasks build upon earlier ones
- A specific learning sequence is required

Use random order when:
- Tasks are independent
- You want to minimize learning or carryover effects, which could bias experimental results
- Order doesn't affect task completion
:::


### Tasks Property: Timer

The global timer sets a default time limit for all tasks, which can be overridden by individual task timers.

```json
{
    "timer": 300,  // Global 5-minute timer
    "tasks": [...]
}
```

:::danger Timer Configuration
Even for impossible tasks, appropriate time limits are crucial:
- Give participants enough time to recognize the impossibility
- Allow for different solution attempts
- Prevent excessive frustration
:::

### Tasks Properties: Abortable & AbortionOptions

The global `abortable` flag controlls whether a task should be abortable per default.
Tasks that are abortable, can be skipped by participants by clicking on the "X" button on the sidebar. 

TODO: example Figure

The global array `abortionOptions` can be used for prompting participants for the reason why they want to abort the task.
If set, the participants have to chose a reason for aborting their current task upon clicking on the "X" button.
Otherwise, they can abort the task without providing a reason and proceed to the next available task, if any.

:::danger Using Abortion Options
The property `abortionOptions` only takes effect if `abortable` is true.
:::

TODO: example Figure

Note that these global properties can be overwritten for each task individually.

## Individual Task Configuration

Each task in the array defines a specific objective with several key components:

### 1. Core Properties

```json
{
    "id": "make_coffee",
    "description": "Make 5 coffees using the coffee machine",
    "timer": 120,  // Optional override of global timer
    "abortable": false,
    "abortionOptions": [ // Optional, only set if abortable = true
        "I believe this task is impossible.",
        "I want to skip this task."
    ]
}
```

### 2. Environment Variables

Environment variables set the context for tasks and influence rule behavior.
TODO: These variables only exist in the scope of a particular task. (correct?)

```json
{
    "environment": [
        { "name": "Weather", "value": "Sunny" },
        { "name": "Temperature", "value": 20 },
        { "name": "RoomOccupied", "value": true }
    ]
}
```

:::tip Environment Usage
Environment variables can:
- Trigger specific rules
- Create realistic scenarios
- Affect device behavior
:::

### 3. Default Device Properties

These properties reset devices to specific initial states when a task begins.

```json
{
    "defaultDeviceProperties": [
        {
            "device": "coffee_machine",
            "properties": [
                { "name": "Power", "value": false },
                { "name": "Roasting", "value": true }
            ]
        }
    ]
}
```

:::danger Initial States
Consider resetting device properties to their initial states at the commence of a new task:
- Prevent premature rule activation
- Ensure consistent starting conditions
- Set up intended impossible scenarios correctly
:::

### 4. Goals

Goals define the conditions required for task completion. Each task must have at least one goal.
For debugging purpose, it is sufficient to leave out the goal.

A task is successfully completed when all goals of its task are met.


```json
{
    "goals": [
        {
            "device": "coffee_machine",
            "property": {
                "name": "Number of Coffees Made",
                "operator": ">=",
                "value": 5
            }
        }
    ]
}
```

:::tip Goal Definition
Even for impossible tasks:
- Define clear, measurable objectives
- Use precise operators and values
- Make the goal requirements obvious to participants
:::

### 5. Rules

Rules create dynamic behavior and can intentionally prevent task completion.

```json
{
    "rules": [
        {
            "name": "Turn Off Coffee Machine",
            "precondition": [
                {
                    "type": "Device",
                    "device": "coffee_machine",
                    "condition": {
                        "name": "Number of Coffees Made",
                        "operator": ">=",
                        "value": 3
                    }
                },
                {
                    "type": "Time",
                    "condition": {
                        "variable": "minute",
                        "operator": ">=",
                        "value": 10
                    }
                }
            ],
            "action": {
                "device": "coffee_machine",
                "property": {
                    "name": "Power",
                    "value": false
                }
            }
        }
    ]
}
```

#### Rule Components

1. **Preconditions**: Define when rules trigger based on:
   - Device properties
   - Environment variables
   - Time conditions


2. **Actions**: Specify what happens when preconditions are met:
   - Change device states
   - Modify environment variables
   - Create contradictory situations

:::important Rule Design
Use rules if you want to create impossible tasks:
- Design contradictions between goals and rules
- Create cascading rule effects
- Ensure impossibility is clear but not immediately obvious
:::

## Best Practices

1. **Task Description**
   - Write clear, unambiguous instructions
   - If a task is not feasible, do not hint at impossibility
   - Maintain consistent terminology

2. **Rule Creation**
   - Design intentional contradictions if your goal is to create confusing situations
   - Test rule interactions thoroughly
   - Document expected "failure" scenarios

3. **Timer Management**
   - Set appropriate time limits
   - Consider task complexity
   - Allow for multiple attempt strategies

:::tip Documentation
Maintain clear documentation of:
- Intended impossible scenarios
- Expected participant behavior
- Rule interaction effects
- Task completion criteria (or why they can't be met)
:::
