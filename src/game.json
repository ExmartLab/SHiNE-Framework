{
    "environment": {
        "time": {
            "startTime": {
                "hour": 8,
                "minute": 0
            },
            "speed": 1
        }
    },
    "tasks": {
        "ordered": "true",
        "timer": 300,
        "tasks": [
            {
                "id": "make_coffee",
                "description": "Make 5 coffee using the coffee machine",
                "timer": 120,
                "environment": [
                    { "name": "Weather", "value": "Sunny" },
                    { "name": "Temperature", "value": 20 }
                ],
                "defaultDeviceProperties": [
                    {
                        "device": "coffee_machine",
                        "properties": [
                            { "name": "Power", "value": false },
                            { "name": "Roasting", "value": true },
                            { "name": "Number of Coffees Made", "value": 0 }
                        ]
                    }
                ],
                "goals": [
                    {
                        "device": "coffee_machine",
                        "property": {
                            "name": "Power",
                            "operator": "==",
                            "value": true
                        }
                    },
                    {
                        "device": "coffee_machine",
                        "property": {
                            "name": "Number of Coffees Made",
                            "operator": ">=",
                            "value": 5
                        }
                    }
                ],
                "rules": [
                    {
                        "name": "Turn Off Coffee Machine",
                        "precondition": [
                            {
                                "type": "Device",
                                "device": "coffee_machine",
                                "condition": {
                                    "name": "Number of Coffees Made",
                                    "operator": ">=",
                                    "value": 3
                                }
                            },
                            {
                                "type": "Time",
                                "condition": {
                                    "variable": "minute",
                                    "operator": ">=",
                                    "value": 10
                                }
                            }
                        ],
                        "action": {
                            "device": "coffee_machine",
                            "property": {
                                "name": "Power",
                                "value": false
                            }
                        }
                    }
                ]
            }
        ]
    },
    "rooms": [
        {
            "name": "Shared Room",
            "walls": [
                {
                    "image": "assets/images/shared_room/wall1.webp",
                    "default": true,
                    "devices": [
                        {
                            "name": "Deep Fryer",
                            "id": "deep_fryer",
                            "image": "assets/images/shared_room/devices/deep_fryer_off.jpg",
                            "position": {
                                "x": 657,
                                "y": 285,
                                "scale": 1,
                                "origin": 1
                            },
                            "interactions":
                            [
                                {
                                    "InteractionType": "Boolean_Action",
                                    "name": "Power",
                                    "inputData": {
                                        "valueType": ["PrimitiveType", "Boolean"],
                                        "unitOfMeasure": null,
                                        "type": {
                                            "True": "On",
                                            "False": "off"
                                        }
                                    },
                                    "currentState": {
                                        "visible": null,
                                        "value": false
                                    }
                                },
                                {
                                    "InteractionType": "Numerical_Action",
                                    "name": "Temperature",
                                    "inputData": {
                                        "valueType": ["PrimitiveType", "Integer"],
                                        "unitOfMeasure": "Â°C",
                                        "type": {
                                            "Range": [0, 200],
                                            "Interval": [50]
                                        }
                                    },
                                    "currentState": {
                                        "visible": [
                                            { "name": "Power", "value": true }
                                        ],
                                        "value": 0
                                    }
                                }
                            ],
                            "visualState": [
                                { "default": true, "image": "assets/images/shared_room/devices/wall1_deepfryer.webp" },
                                {
                                "default": false,
                                "conditions": [
                                    { "name": "Power", "value": true },
                                    { "name": "Temperature", "operator": "<=", "value": 50 }
                                ],
                                "image": "assets/images/shared_room/devices/wall1_deepfryer_low_temp.webp"
                                },
                                {
                                    "default": false,
                                    "conditions": [
                                        { "name": "Power", "value": true },
                                        { "name": "Temperature", "operator": ">", "value": 50 },
                                        { "name": "Temperature", "operator": "<=", "value": 100 }
                                    ],
                                    "image": "assets/images/shared_room/devices/wall1_deepfryer_med_temp.webp"
                                },
                                {
                                    "default": false,
                                    "conditions": [
                                        { "name": "Power", "value": true },
                                        { "name": "Temperature", "operator": ">", "value": 100 },
                                        { "name": "Temperature", "operator": "<=", "value": 200 }
                                    ],
                                    "image": "assets/images/shared_room/devices/wall1_deepfryer_high_temp.webp"
                                }
                            ]
                        },
                        {
                            "name": "Coffee Machine",
                            "id": "coffee_machine",
                            "image": "assets/images/shared_room/devices/wall1_coffee_machine.png",
                            "position": {
                                "x": 357,
                                "y": 285,
                                "scale": 0.25,
                                "origin": 1
                            },
                            "interactions":
                            [
                                {
                                    "InteractionType": "Boolean_Action",
                                    "name": "Power",
                                    "inputData": {
                                        "valueType": ["PrimitiveType", "Boolean"],
                                        "unitOfMeasure": null,
                                        "type": {
                                            "True": "On",
                                            "False": "off"
                                        }
                                    },
                                    "currentState": {
                                        "visible": null,
                                        "value": false
                                    }
                                },
                                {
                                    "InteractionType": "Boolean_Action",
                                    "name": "Roasting",
                                    "inputData": {
                                        "valueType": ["PrimitiveType", "Boolean"],
                                        "unitOfMeasure": null,
                                        "type": {
                                            "True": "High",
                                            "False": "Low"
                                        }
                                    },
                                    "currentState": {
                                        "visible": null,
                                        "value": false
                                    }
                                }
                            ],
                            "visualState": [
                                { "default": true, "image": "assets/images/shared_room/devices/wall1_coffee_machine.png" }
                            ]
                        }
                    ]
                },
                {
                    "image": "assets/images/shared_room/wall2.webp",
                    "default": false
                },
                {
                    "image": "assets/images/shared_room/wall3.webp",
                    "devices": {
                        "tv": {
                            "states": {
                                "off": {
                                    "image": "assets/images/shared_room/devices/tv_off.jpg",
                                    "default": true
                                },
                                "channel1": {
                                    "image": "assets/images/shared_room/devices/tv_channel.jpg",
                                    "default": false
                                },
                                "channel2": {
                                    "image": "assets/images/shared_room/devices/tv_channel.jpg",
                                    "default": false
                                },
                                "channel3": {
                                    "image": "assets/images/shared_room/devices/tv_channel.jpg",
                                    "default": false
                                }
                            },
                            "current_state": "off",
                            "variables": {
                                "channel": 0
                            },
                            "position": {
                                "x": 200,
                                "y": 400,
                                "scale": 0.5
                            },
                            "functions": {
                                "turn_on": {
                                    "name": "Turn On TV",
                                    "function": "function(state, variables) { if(state == 'off') { variables.channel = 1; state = 'channel1'; } }"
                                },
                                "next_channel": {
                                    "name": "Next Channel",
                                    "function": "function(state, variables) { if(state == 'on') { variables.channel++; } }"
                                }
                            }
                        }
                    }
                },
                {
                    "image": "assets/images/shared_room/wall4.webp",
                    "doors": [
                        {
                            "image": "assets/images/shared_room/doors/wall4_door.webp",
                            "position": {
                                "x": 425,
                                "y": 100,
                                "scale": 0.5
                            },
                            "destination": {
                                "room": "bob_room",
                                "wall": "wall1"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "Bob Room",
            "walls": [
                {
                    "image": "assets/images/bob_room/wall1.webp",
                    "default": false,
                    "doors": [
                        {
                            "image": "assets/images/bob_room/doors/wall1_door.webp",
                            "position": {
                                "x": 0,
                                "y": 24,
                                "scale": 0.5
                            },
                            "destination": {
                                "room": "shared_room",
                                "wall": "wall1"
                            }
                        }
                    ]
                },
                {
                    "image": "assets/images/bob_room/wall2.webp",
                    "default": false
                },
                {
                    "image": "assets/images/bob_room/wall3.webp",
                    "default": false
                },
                {
                    "image": "assets/images/bob_room/wall4.webp",
                    "default": false
                }
            ]
        }
    ],
    "rules": [
        {
            "name": "Turn On Deep Fryer",
            "condition": "function(devices) { return shared_room.wall1.devices.deep_fryer.variables.temperature > 200; }",
            "action": "function(devices) { shared_room.wall1.devices.deep_fryer.functions.turn_off(shared_room.wall1.devices.deep_fryer.current_state, shared_room.wall1.devices.deep_fryer.variables); }"
        }
    ]
}