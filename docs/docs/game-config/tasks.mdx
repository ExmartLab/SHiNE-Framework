---
sidebar_position: 3
---

import CodeBlock from '@theme/CodeBlock';
import generateResolverOptions from "@site/src/components/shared-lib/generateResolverOptions.tsx";
import JSONSchemaViewer from "@theme/JSONSchemaViewer";
import TaskSchema from "@site/static/schemas/taskSchema.json";

# Tasks

During the game-based study, participants complete various tasks related to smart home devices. These tasks range from simple actions like turning on devices to complex scenarios where smart home rules intentionally create impossible situations. For example, a task might require making coffee while rules automatically power off the coffee machine, creating an intentionally impossible scenario to study participant behavior.

## JSON Schema

<JSONSchemaViewer schema={ TaskSchema } resolverOptions={generateResolverOptions({"basePath": "/schemas"})} />

## Global Task Configuration

Tasks have two primary global properties that control their presentation and timing: `ordered` and `timer`.

### Tasks Property: Order

The `ordered` property determines whether tasks appear in a fixed sequence or random order.

```json
{
    "ordered": true,
    "tasks": [
        { "id": "task_a", "description": "First task" },
        { "id": "task_b", "description": "Second task" },
        { "id": "task_c", "description": "Third task" }
    ]
}
```

#### Order Behavior

- When `ordered: true`: Tasks appear in array order (e.g., Task A → Task B → Task C)
- When `ordered: false`: Tasks are shuffled (e.g., Task C → Task A → Task B)

:::tip Choosing Task Order
Use ordered tasks when:
- Tasks follow a logical progression
- Later tasks build upon earlier ones
- A specific learning sequence is required

Use random order when:
- Tasks are independent
- You want to minimize learning effects
- Order doesn't affect task completion
:::

TODO: Why did we chose for ordered: false?

### Tasks Property: Timer

The global timer sets a default time limit for all tasks, which can be overridden by individual task timers.

```json
{
    "timer": 300,  // Global 5-minute timer
    "tasks": [...]
}
```

:::danger Timer Configuration
Even for impossible tasks, appropriate time limits are crucial:
- Give participants enough time to recognize the impossibility
- Allow for different solution attempts
- Prevent excessive frustration
:::

## Individual Task Configuration

Each task in the array defines a specific objective with several key components:

### 1. Core Properties

```json
{
    "id": "make_coffee",
    "description": "Make 5 coffees using the coffee machine",
    "timer": 120  // Optional override of global timer
}
```

### 2. Environment Variables

Environment variables set the context for tasks and influence rule behavior.

```json
{
    "environment": [
        { "name": "Weather", "value": "Sunny" },
        { "name": "Temperature", "value": 20 },
        { "name": "RoomOccupied", "value": true }
    ]
}
```

:::tip Environment Usage
Environment variables can:
- Trigger specific rules
- Create realistic scenarios
- Affect device behavior
:::

### 3. Default Device Properties

These properties reset devices to specific states when a task begins.

```json
{
    "defaultDeviceProperties": [
        {
            "device": "coffee_machine",
            "properties": [
                { "name": "Power", "value": false },
                { "name": "Roasting", "value": true }
            ]
        }
    ]
}
```

:::danger Initial States
Proper initial states are crucial:
- Prevent premature rule activation
- Ensure consistent starting conditions
- Set up intended impossible scenarios correctly
:::

### 4. Goals

Goals define the conditions required for task completion. Each task must have at least one goal.

```json
{
    "goals": [
        {
            "device": "coffee_machine",
            "property": {
                "name": "Number of Coffees Made",
                "operator": ">=",
                "value": 5
            }
        }
    ]
}
```

:::tip Goal Definition
Even for impossible tasks:
- Define clear, measurable objectives
- Use precise operators and values
- Make the goal requirements obvious to participants
:::

### 5. Rules

Rules create dynamic behavior and can intentionally prevent task completion.

```json
{
    "rules": [
        {
            "name": "Turn Off Coffee Machine",
            "precondition": [
                {
                    "type": "Device",
                    "device": "coffee_machine",
                    "condition": {
                        "name": "Number of Coffees Made",
                        "operator": ">=",
                        "value": 3
                    }
                },
                {
                    "type": "Time",
                    "condition": {
                        "variable": "minute",
                        "operator": ">=",
                        "value": 10
                    }
                }
            ],
            "action": {
                "device": "coffee_machine",
                "property": {
                    "name": "Power",
                    "value": false
                }
            }
        }
    ]
}
```

#### Rule Components

1. **Preconditions**: Define when rules trigger based on:
   - Device properties
   - Environment variables
   - Time conditions

TODO: Shall precondition depend on task environment variables too?

2. **Actions**: Specify what happens when preconditions are met:
   - Change device states
   - Modify environment variables
   - Create contradictory situations

:::important Rule Design
Rules are key to creating impossible tasks:
- Design contradictions between goals and rules
- Create cascading rule effects
- Ensure impossibility is clear but not immediately obvious
:::

## Best Practices

1. **Task Description**
   - Write clear, unambiguous instructions
   - Don't hint at impossibility
   - Maintain consistent terminology

2. **Rule Creation**
   - Design intentional contradictions
   - Test rule interactions thoroughly
   - Document expected "failure" scenarios

3. **Timer Management**
   - Set appropriate time limits
   - Consider task complexity
   - Allow for multiple attempt strategies

:::tip Documentation
Maintain clear documentation of:
- Intended impossible scenarios
- Expected participant behavior
- Rule interaction effects
- Task completion criteria (or why they can't be met)
:::

## Related Topics
- Device Configuration
- Environment Variables
- Rule System
- Timer Management